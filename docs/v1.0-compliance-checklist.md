# KIVAI v1.0 — Compliance Checklist

This document defines the mandatory compliance requirements for any:

- Device
- Adapter
- Gateway
- Module
- Product Pack

claiming KIVAI v1.0 compatibility.

This checklist is deterministic and auditable.

---

# 1️⃣ Intent Contract Compliance

A compliant implementation MUST:

- Use `schema/kivai-intent-v1.schema.json`
- Validate intents before execution
- Reject invalid payloads with `SCHEMA_INVALID`
- Never accept free-form natural language at execution layer
- Require:
  - `intent_id`
  - `intent`
  - `target`
  - `meta`

---

# 2️⃣ Targeting Compliance

The runtime MUST support:

- Direct targeting (`device_id`)
- Capability + zone targeting fallback

At least one of:

- `target.device_id`
- OR `target.capability + target.zone`

Routing must be deterministic.

---

# 3️⃣ Authorization Compliance

The runtime MUST:

- Evaluate authorization before execution
- Return `AUTH_REQUIRED` deterministically when proof is missing
- Never allow adapters to make authorization decisions

Sensitive intents MUST declare baseline role requirements.

---

# 4️⃣ Adapter Compliance

Every adapter MUST:

- Declare `intent`
- Implement `execute(payload, ctx)`
- Return normalized output:
  - `{ ok: true, ... }`
  - OR `{ ok: false, error: { code, message } }`
- Declare required capabilities in strict mode

Adapters MUST NOT:
- Perform schema validation
- Override routing logic
- Modify authorization logic

---

# 5️⃣ ACK Envelope Compliance

All executions MUST return a deterministic ACK:

Required fields:

- `execution_id`
- `intent_id`
- `timestamp`
- `status`
- `intent`

Optional but recommended:

- `device_id`
- `route`
- `result`
- `error`

Error codes MUST be machine-readable.

---

# 6️⃣ Audit Compliance

Gateway implementations MUST:

- Emit structured execution events
- Include `execution_id`
- Log:
  - start
  - auth evaluation
  - schema validation
  - routing resolution
  - execution end

Audit logs must be tamper-resistant in production deployments.

---

# 7️⃣ Strict Mode Compliance (v1.0+)

In strict mode:

- No payload normalization
- No automatic field injection
- No default meta creation
- Schema must pass as-is

Strict mode ensures production-grade determinism.

---

# 8️⃣ Versioning Compliance

- Schema version MUST be frozen per major release
- Breaking changes require:
  - New schema version
  - Migration documentation
  - Deprecation timeline

---

# 9️⃣ Security Baseline

Sensitive intents include (non-exhaustive):

- unlock_door
- lock_control
- payment
- alarm_control
- surveillance_activation

These MUST require explicit authorization proof.

---

# 1️⃣0️⃣ Certification Statement

An implementation may declare:

"KIVAI v1.0 Compatible"

ONLY if all checklist items are satisfied.

Partial implementations must declare:

"KIVAI v1.0 Subset Implementation"
